name: .NET Core + Webpack

on:
  push:
    branches: [ principal ]
    
  workflow_dispatch:
  
jobs:
  build-front:
    strategy:
      matrix:
        node-version: [14.x]    
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2        
      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v1
        with:
          node-version: ${{ matrix.node-version }}
      - name: Install NPM packages        
        run: npm install
        working-directory: ./FrontEnd
      - name: Publish frontend        
        run: npm run publish --if-present
        working-directory: ./FrontEnd
      - name: S3 Deploy
      # You may pin to the exact commit or the version.
      # uses: Reggionick/s3-deploy@d78e6b5a588e326e4b1afb9b33df2ce28929e5e1
        uses: Reggionick/s3-deploy@v3.1.0
        with:
          # Directory to deploy
          folder: ./dist
          # Name of AWS Bucket
          bucket: super-googles
          # The destination bucket region
          bucket-region: us-east-2
          # AWS CloudFront distribution ID
          #dist-id: # optional
          # AWS CloudFront invalidation path(s)
          #invalidation: # optional
          # Removes files in S3 that are not available in the local copy of the directory
          delete-removed: true
          # Use this parameter to specify Cache-Control: no-cache, no-store, must-revalidate header
          no-cache: must-revalidate
          # Upload files with private ACL, needed for S3 static website hosting
          private: true
        
